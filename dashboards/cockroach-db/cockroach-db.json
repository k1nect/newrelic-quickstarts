{
  "name": "Cockroach Database Console",
  "description": null,
  "pages": [
    {
      "name": "Storage",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 3,
            "height": 8
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "![CockroachDB Logo](https://raw.githubusercontent.com/newrelic/newrelic-quickstarts/main/quickstarts/cockroach-db/logo.png) \n- - -\n\n### Overview\n[CockroacDB](https://github.com/cockroachdb/cockroach) is a distributed SQL database built on a transactional and strongly-consistent key-value store. It scales horizontally; survives disk, machine, rack, and even datacenter failures with minimal latency disruption and no manual intervention; supports strongly-consistent ACID transactions; and provides a familiar SQL API for structuring, manipulating, and querying data.\n\n\n[CockroacDB](https://github.com/cockroachdb/cockroach) generates detailed time series metrics for each node in a cluster. This [page](https://www.cockroachlabs.com/docs/stable/monitor-cockroachdb-with-prometheus.html) shows you how to pull these metrics into Prometheus.\n\n### About this Dashboard\nThis dashboard is based on standard `CockraochDB` Prometheus metrics ingested using Prometheus [remote write](https://one.newrelic.com/marketplace/catalog-pack-details/detail?state=d8bbbb94-e24f-8ef8-a440-f815fc4b340a). Using the maximum dimensions of metrics as facets, a comprehensive view of CockroachDB can be obtained from this dashboard. \n\n\n### Troubleshooting\nIf you don't see data, you may not be configuring Prometheus to monitor itself. You should also check the 'New Relic Usage and Errors' tab to look for any errors reported there.\n\nOn the sending side, it's important to look for logged errors related to requests and rate limits. In your Prometheus logs, you may see errors like: server returned HTTP status 429 Too Many Requests: {}. Failures shown 'Prometheus Datapoint Send Failures' chart are also an indication that you should check your server logs.\n\nUsing remote write increases the memory footprint of Prometheus Server. You can use the the 'Prometheus Server Monitoring' tab to monitor the general health of your prometheus server(s).\n\nIn Prometheus, data from the write-ahead log (WAL) is sharded across in-memory queues before being sent to remote endpoints. Resource utilization is governed by the number of shards, number of samples per shard, and number of samples sent per request to an endpoint. For more information, consult the documentation on remote write tuning ."
          }
        },
        {
          "title": "Active Nodes ",
          "layout": {
            "column": 4,
            "row": 1,
            "width": 2,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric \nSELECT latest(liveness_livenodes) as 'Active Nodes'\nWHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') compare WITH 24 hour ago"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Capacity",
          "layout": {
            "column": 6,
            "row": 1,
            "width": 4,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT  sum(`Max_capacity`) As 'Max Capacity', ((average(`Max_capacity`) * cardinality(`Max_capacity`)) - (average(`Available_capacity`) * cardinality(`Available_capacity`))) As 'Used Capacity' ,  sum(`Available_capacity`) As 'Avaliable Capacity' FROM (SELECT (average(capacity) * cardinality(capacity)) AS `Max_capacity`, (average(capacity_available) * cardinality(capacity_available)) AS `Available_capacity` FROM Metric  WHERE ((app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') )  FACET instance ) FACET instance"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "File Descriptors",
          "layout": {
            "column": 10,
            "row": 1,
            "width": 3,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT (average(`sys_fd_open_number`) * cardinality(`sys_fd_open_number`)) As 'Open(Avg)', sum(sys_fd_softlimit_number) AS 'Soft Limit' FROM (SELECT (average(sys_fd_open) * cardinality(sys_fd_open)) AS `sys_fd_open_number`,  (average(sys_fd_softlimit) * cardinality(sys_fd_softlimit)) AS `sys_fd_softlimit_number` FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') And (instrumentation.name='remote-write') FACET instance ) FACET instance"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "SSTables",
          "layout": {
            "column": 4,
            "row": 3,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT (average(rocksdb_num_sstables) * cardinality(rocksdb_num_sstables)) FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') Facet instance TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Compactions ( Written Bytes)",
          "layout": {
            "column": 8,
            "row": 3,
            "width": 5,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT  latest(rocksdb_compactions) As 'Compactions'  FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') facet instance  TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Log Commit Latency: 99p",
          "layout": {
            "column": 4,
            "row": 6,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(raft_process_logcommit_latency_bucket,99)/1000000 FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write')  FACET instance   TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Command Commit Latency: 99p",
          "layout": {
            "column": 8,
            "row": 6,
            "width": 5,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(raft_process_commandcommit_latency_bucket, 99) / 1000000  FROM Metric WHERE ((app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write'))  FACET instance TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "seriesOverrides": [
                {
                  "seriesName": "cluster=my-cockroachdb-cluster,instance=localhost:8080,instrumentation.name=remote-write,instrumentation.provider=prometheus,instrumentation.source=nginx-cockroachDb-Growth,instrumentation.version=0.0.2,job=cockroachdb,newrelic.source=prometheusAPI,prometheus_server=nginx-cockroachDb-Growth,store=1"
                }
              ],
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Flushes (Writen Bytes) ",
          "layout": {
            "column": 1,
            "row": 9,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(rocksdb_flushes) As Flushes FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') facet instance  TIMESERIES 300000 slide by 30000 "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Read Amplification(factor)",
          "layout": {
            "column": 5,
            "row": 9,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(`average number of real read operations`) FROM (SELECT average(rocksdb_read_amplification) AS `average number of real read operations` FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') FACET instance LIMIT 100 TIMESERIES 30000 slide by 30 seconds) FACET instance TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Live Bytes ",
          "layout": {
            "column": 9,
            "row": 9,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(livebytes) AS `Live` FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  Facet instance TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 12,
            "width": 12,
            "height": 1
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "# Timeseries Writes"
          }
        },
        {
          "title": "Bytes Written (KiB)",
          "layout": {
            "column": 1,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(timeseries_write_bytes)/1000, 1 SECONDS) As 'Bytes Written (KBs)' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') facet instance  TIMESERIES 5 minutes SLIDE BY 30 seconds"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Sample Written (Count)",
          "layout": {
            "column": 5,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(timeseries_write_samples), 1 SECONDS) As 'Sample Written' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') facet instance TIMESERIES 5 minutes SLIDE BY 30 seconds"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Errors (Count)",
          "layout": {
            "column": 9,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(timeseries_write_errors), 1 SECONDS) As 'Errors' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') facet instance  TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "SQL",
      "description": null,
      "widgets": [
        {
          "title": "Live SQL Connection",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(sql_conns) As 'Live SQL Connections' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') and (instrumentation.name='remote-write') SINCE 60 MINUTES AGO UNTIL NOW Compare with 1 hour ago Facet instance"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "SQL Statements (All Nodes)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_select_count), 1 SECONDS) as 'Selects' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_insert_count), 1 SECONDS) AS Inserts FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')SINCE 60 MINUTES AGO UNTIL NOW TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_update_count), 1 SECONDS) As 'Updates' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_delete_count), 1 SECONDS) As 'Deletes' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_failure_count_count), 1 SECONDS) As 'Failures' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 600000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Transactions (All Nodes)",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_txn_begin_count), 1 SECONDS) as 'Begins' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_txn_commit_count), 1 SECONDS) AS Commits FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_txn_rollback_count), 1 SECONDS) As 'Rollbacks' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_txn_abort_count), 1 SECONDS) As 'Aborts' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') SINCE 60 MINUTES AGO UNTIL NOW TIMESERIES 600000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "SQL Memory",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(sql_mem_root_current) FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  FACET instance TIMESERIES 300000 Slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "SQL Statement Errors (All Nodes)",
          "layout": {
            "column": 5,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_failure_count), 1 SECONDS) As 'Error Rate' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 300000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "SQL Byte Traffic (All Nodes)",
          "layout": {
            "column": 9,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_bytesin), 1 SECONDS) AS 'Byte In' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') SINCE 60 MINUTES AGO UNTIL NOW TIMESERIES 600000 SLIDE BY 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sql_bytesout), 1 SECONDS)As 'Byte Out'FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') SINCE 60 MINUTES AGO UNTIL NOW TIMESERIES 600000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Transactions Latency: 99p",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(sql_txn_latency_bucket, 99)/1000000 FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') SINCE 60 MINUTES AGO UNTIL NOW FACET instance LIMIT 100 TIMESERIES 300000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "SECONDS"
            },
            "yAxisLeft": {
              "zero": false
            }
          }
        },
        {
          "title": "Service Latency: SQL, 99p",
          "layout": {
            "column": 5,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(sql_service_latency_bucket, 99)/1000000 As 'Service Latency' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  FACET instance  TIMESERIES 300000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "KV Execution Latency: 99p",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(exec_latency_bucket, 99)/1000000 FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') SINCE 60 MINUTES AGO UNTIL NOW FACET instance  TIMESERIES 300000 SLIDE BY 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": false
            }
          }
        },
        {
          "title": "Open SQL Transactions",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(sql_txns_open) FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  FACET instance  TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Active SQL Statements",
          "layout": {
            "column": 5,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(sql_distsql_queries_active) As 'Active SQL Statements' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%')AND (instrumentation.name='remote-write') facet instance TIMESERIES 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Schema Changes",
          "layout": {
            "column": 9,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(sql_ddl_count) As 'Schema Changes' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%')AND (instrumentation.name='remote-write')  TIMESERIES 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Runtime",
      "description": null,
      "widgets": [
        {
          "title": "Active Nodes ",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric \nSELECT latest(liveness_livenodes) as 'Active Nodes'\nWHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') compare WITH 24 hour ago"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Goroutine Count",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(sys_goroutines)  As 'Goroutine Count' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') And (instrumentation.name='remote-write') facet instance  TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": false
            }
          }
        },
        {
          "title": "Garbage Collection Runs / Seconds ( All Nodes)",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(sum(sys_gc_count) , 1 SECONDS)as 'Garbage Collection Run' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write')  TIMESERIES 30000 "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Replicas/Node",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(replicas) As 'Replicas Per Node' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') facet instance COMPARE WITH 1 day ago"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Average Memory Usage ( All Nodes)",
          "layout": {
            "column": 5,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT (average(sys_go_totalbytes) * cardinality(sys_go_totalbytes)) AS 'Memory managed by the Go layer' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') TIMESERIES 300000 slide by 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT (average(sys_go_allocbytes) * cardinality(sys_go_allocbytes)) As 'Memory allocated by the Go layer' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') TIMESERIES 300000 slide by 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT (average(sys_cgo_totalbytes) * cardinality(sys_cgo_totalbytes)) As 'Memory managed by the C layer' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write') TIMESERIES 300000 slide by 30000"
              },
              {
                "accountId": 0,
                "query": "SELECT (average(sys_cgo_allocbytes) * cardinality(sys_cgo_allocbytes)) As 'Memory allocated by the C layer' FROM Metric WHERE ((app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name = 'remote-write')) TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "CPU Time (Nano Seconds) ",
          "layout": {
            "column": 9,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT idelta(sys_cpu_user_ns) As 'User' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') And (instrumentation.name='remote-write')  TIMESERIES "
              },
              {
                "accountId": 0,
                "query": "SELECT idelta(sys_cpu_sys_ns) As 'System' FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') And (instrumentation.name='remote-write')  TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Runnable Goroutines per CPU",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(sys_runnable_goroutines_per_cpu) FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') AND (instrumentation.name='remote-write') facet instance TIMESERIES 300000 slide by 30000 "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Clock Offset",
          "layout": {
            "column": 5,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(clock_offset_meannanos)/1000000 FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%')  FACET instance LIMIT 100 TIMESERIES 300000 slide by 30000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": false
            }
          }
        },
        {
          "title": "GC Pause Time (seconds)",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT idelta(sys_gc_pause_ns)/1000000000 FROM Metric WHERE (app_kubernetes_io_name LIKE '%cockroach%' or app_newrelic_com_name LIKE '%cockroach%') facet instance TIMESERIES  300000\n\n"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "SECONDS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    }
  ]
}